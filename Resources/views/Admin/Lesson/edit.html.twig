{% extends 'SmirikCourseBundle:Admin:layout.html.twig' %}

{% block title %}{{ 'admin.lesson.edit.page_title'|trans }}{% endblock %}

{% block header %}
<h1>{{ entity.title }} <small>{{ 'admin.lesson.edit.title.comment'|trans }}</small></h1>
{% endblock %}

{% block body %}

<div class="tabbable">
  <ul id="tab" class="nav nav-tabs">
    <li class="active"><a href="#home" data-toggle="tab">{{ 'admin.lesson.edit.lesson.main'|trans }}</a></li>
    <li><a href="#textcontent" data-toggle="tab">{{ 'admin.lesson.edit.lesson.text'|trans }}</a></li>
    <li><a href="#urlcontent" data-toggle="tab">{{ 'admin.lesson.edit.lesson.url'|trans }}</a></li>
    <li><a href="#youtubecontent" data-toggle="tab">{{ 'admin.lesson.edit.lesson.youtube'|trans }}</a></li>
  </ul>
</div>

<form action="{{ path('admin_lessons_update', { 'id': entity.id }) }}" method="post" {{ form_enctype(edit_form) }} class="form-horizontal">
	<fieldset>
    {{ form_errors(edit_form) }}
 
<div class="tab-content">

    <div class="tab-pane fade in active" id="home">
      {{ form_row(edit_form.course) }}
      {{ form_row(edit_form.title) }}
      {{ form_row(edit_form._token) }}
    </div>
    
    <div id="textcontent" class="tab-pane fade">
      <ul class="unstyled">
  			{% for text in edit_form.text_content %}
  			  <li> <h3 class="bottom_line">{{ text.vars.value.title }}</h3>
  			    <ul class="unstyled">
      				<li>{{ form_row(text.title)}}</li>
      				<li>{{ form_row(text.description)}}</li>
      				<li>{{ form_row(text.text)}}</li>
  			    </ul>
  			  </li>
  			{% endfor %}
  		</ul>
		</div>
    
    <div id="urlcontent" class="tab-pane fade">
      <ul class="unstyled">
  			{% for url in edit_form.url_content %}
			    <li> <h3 class="bottom_line">{{ url.vars.value.title }}</h3>
  			    <ul class="unstyled">
      				<li>{{ form_row(url.title)}}</li>
      				<li>{{ form_row(url.description)}}</li>
      				<li>{{ form_row(url.url)}}</li>
  			    </ul>
  			  </li>
  			{% endfor %}
  		</ul>
		</div>

    <div id="youtubecontent" class="tab-pane fade">
      <ul class="unstyled">
  			{% for url in edit_form.youtube_content %}
		      <li> <h3 class="bottom_line">{{ url.vars.value.title }}</h3>
  			    <ul class="unstyled">
      				<li>{{ form_row(url.title)}}</li>
      				<li>{{ form_row(url.description)}}</li>
      				<li>{{ form_row(url.url)}}</li>
  			    </ul>
  			  </li>
  			{% endfor %}
  		</ul>
		</div>
    
      {% if false %}
  		<p>
  		<a href="#" class="ajax" onclick="$('#admin_lessons_text_content').toggle()">{{ 'admin.lesson.edit.text-content-show'|trans }}</a>
  		</p>
		
  		<ul>
  			{% for text in entity.textcontent %}
  				<li><a class="ajax" href="#" data-controls-modal="myform" data-keyboard="true" data-backdrop="static" >{{ text.title}}</a></li>
  			{% endfor %}
  		</ul>
		
  		{% for form in text_content_forms %}
  		  {% include 'SmirikCourseBundle:Admin/Lesson:modal_form.html.twig' with {'form': form, 'form_name': 'myform' } %}
  		{% endfor %}

      {% endif %}
		
</div>

  <div class="well">
     <button type="submit" class="btn btn-primary">{{ 'admin.course.action.save'|trans }}</button>
  </div>

	</fieldset>
</form>

<script>
  $(function () {
    $('.nav-tabs a:first').tab('show')
  })
</script>

<form action="{{ path('admin_lessons_delete', { 'id': entity.id }) }}" method="post">
<div class="well">
    {{ form_widget(delete_form) }}
		<a href="{{ path('admin_lessons', { 'course_id': entity.course.id }) }}" class="btn">
		    {{ 'admin.course.action.back'|trans }}
		</a>
    <button type="submit" class="btn btn-danger">{{ 'admin.course.action.delete'|trans }}</button>
</div>
</form>
{% endblock %}